import{r as e,j as s}from"./D-s6PRqiKBLBeb70.js";import{c as t,b as a}from"./BfZ2chxSRdnyRXRh.js";import{N as r,M as o,f as n,h as i}from"./CjBMIK3HktuBPqZ_.js";import{t as l,F as c,T as d,l as m,S as x,u,s as g}from"./DuhNfJysh32dzoQX.js";import"./DRKqkMc30zo_0ikY.js";import"./CW___00ulSquyL62.js";import"./Dzd9VM057lnHWOrh.js";import"./BOmSRhSE5z7Kpxtd.js";import"./Dud8YmOKJJ5dkhIL.js";import"./BeLtu-UYPkietiDK.js";import"./LM2JspYDBI8LNjlT.js";import"./3aNFxleMQdjaFZtw.js";import"./DZoN2sFbwskeIicV.js";import"./DpIj8wd6VUmqXzzl.js";import"./rok5ZiflEFTZ0mAl.js";import"./CxGgxkmD02DlAHB9.js";import"./CdjEVO9ucAe6ofNA.js";import"./BDEOJ3om1uRt4ddv.js";const p=()=>{const p=t(),[h,f]=e.useState("all"),j=e.useRef(null);e.useEffect(()=>{p.resetQueries({queryKey:["topRatedMovies"]}),p.resetQueries({queryKey:["topRatedTVShows"]})},[p]);const{data:b,fetchNextPage:v,hasNextPage:y,isFetchingNextPage:N,isLoading:w,error:M}=a(["topRatedMovies"],async({pageParam:e=1})=>{const s=await n(e);return{results:s.map(e=>({...e,mediaType:"movie",vote_average:e.vote_average||0})),nextPage:e+1,hasMore:20===s.length&&e<3}},{getNextPageParam:e=>e.hasMore?e.nextPage:void 0,staleTime:0,cacheTime:0,refetchOnMount:!0,refetchOnWindowFocus:!1}),{data:P,fetchNextPage:T,hasNextPage:k,isFetchingNextPage:R,isLoading:Q,error:S}=a(["topRatedTVShows"],async({pageParam:e=1})=>{const s=await i(e);return{results:s.map(e=>({...e,mediaType:"tv",vote_average:e.vote_average||0})),nextPage:e+1,hasMore:20===s.length&&e<3}},{getNextPageParam:e=>e.hasMore?e.nextPage:void 0,staleTime:0,cacheTime:0,refetchOnMount:!0,refetchOnWindowFocus:!1});e.useEffect(()=>{},[M,S]);const F=e.useCallback(e=>{w||Q||(j.current&&j.current.disconnect(),j.current=new IntersectionObserver(e=>{e[0].isIntersecting&&("movies"===h&&y&&!N?v():"tv"===h&&k&&!R?T():"all"===h&&(y||k)&&(y&&!N&&v(),k&&!R&&T()))}),e&&j.current.observe(e))},[w,Q,h,y,k,N,R,v,T]);e.useEffect(()=>(p.prefetchInfiniteQuery(["topRatedMovies"]),p.prefetchInfiniteQuery(["topRatedTVShows"]),()=>{p.removeQueries(["topRatedMovies"]),p.removeQueries(["topRatedTVShows"])}),[p]);const V=w||Q,z=N||R,C=(()=>{const e=b?.pages?.flatMap(e=>e.results)??[],s=P?.pages?.flatMap(e=>e.results)??[];let t=[];if("all"===h){const a=[],r=Math.max(e.length,s.length);for(let t=0;t<r;t++)e[t]&&a.push(e[t]),s[t]&&a.push(s[t]);t=a.slice(0,100)}else"movies"===h?t=e:"tv"===h&&(t=s);return t})(),I=!!M||!!S,O=e=>0===e?"bg-yellow-500":1===e?"bg-gray-300":2===e?"bg-amber-600":"bg-brand",_=e=>0===e?s.jsx(u,{className:"h-4 w-4"}):e<=2?s.jsx(l,{className:"h-4 w-4"}):e<=9?s.jsx(g,{className:"h-4 w-4"}):null;return s.jsxs(s.Fragment,{children:[s.jsx(r,{}),s.jsx("div",{className:"min-h-screen pt-16 bg-background",children:s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"flex flex-col items-center text-center mb-12",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 bg-brand/10 text-brand px-6 py-2 rounded-full mb-4",children:[s.jsx(l,{size:20}),s.jsx("span",{className:"font-semibold",children:"IMDb Top 100"})]}),s.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground/90 mb-2",children:"Highest Rated Content"}),s.jsx("p",{className:"text-foreground/60 max-w-2xl",children:"Discover the most acclaimed movies and TV shows, ranked by IMDb ratings and user reviews"}),s.jsxs("div",{className:"flex justify-center gap-2 bg-secondary/30 backdrop-blur-sm p-1 rounded-full mt-8",children:[s.jsx("button",{onClick:()=>f("all"),className:"flex items-center gap-2 px-4 py-2 rounded-full transition-all duration-300 "+("all"===h?"bg-brand text-background":"text-foreground/60 hover:text-foreground"),children:"All (100)"}),s.jsxs("button",{onClick:()=>f("movies"),className:"flex items-center gap-2 px-4 py-2 rounded-full transition-all duration-300 "+("movies"===h?"bg-brand text-background":"text-foreground/60 hover:text-foreground"),children:[s.jsx(c,{size:18}),"Movies (50)"]}),s.jsxs("button",{onClick:()=>f("tv"),className:"flex items-center gap-2 px-4 py-2 rounded-full transition-all duration-300 "+("tv"===h?"bg-brand text-background":"text-foreground/60 hover:text-foreground"),children:[s.jsx(d,{size:18}),"TV Shows (50)"]})]})]}),V?s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[s.jsx(m,{className:"h-10 w-10 animate-spin text-brand"}),s.jsx("p",{className:"text-foreground/60",children:"Loading top rated content..."})]}):I?s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-4 text-red-500",children:[s.jsx("p",{children:"There was an error loading the content. Please try again later."}),s.jsx("button",{onClick:()=>{p.resetQueries({queryKey:["topRatedMovies"]}),p.resetQueries({queryKey:["topRatedTVShows"]})},className:"px-4 py-2 bg-brand text-background rounded-md hover:bg-brand/90 transition-colors",children:"Retry"})]}):s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 md:gap-6",children:C.map((e,t)=>s.jsxs("div",{ref:t===C.length-1?F:void 0,className:"relative group",children:[s.jsx("div",{className:`absolute -top-3 -left-3 z-10 ${O(t)} text-background font-bold w-10 h-10 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300`,children:s.jsxs("div",{className:"flex flex-col items-center justify-center",children:[_(t),s.jsx("span",{className:"text-sm",children:t+1})]})}),s.jsxs("div",{className:"absolute top-2 right-2 z-10 bg-background/80 backdrop-blur-sm text-foreground text-sm font-semibold px-3 py-1.5 rounded-lg flex items-center gap-1.5",children:[s.jsx(x,{size:14,className:"text-brand fill-brand"}),(e.vote_average||0).toFixed(1)]}),s.jsx(o,{item:e})]},`${e.id}-${e.mediaType}-${t}`))}),z&&s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(m,{className:"h-8 w-8 animate-spin text-brand"})})]})})]})};export{p as default};
